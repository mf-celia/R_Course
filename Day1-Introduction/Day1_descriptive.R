## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(echo = TRUE,comment="", message=FALSE, warning=FALSE, cache=TRUE, fig.width = 4, fig.height = 4)
options(width=80)

## ------------------------------------------------------------------------
1+1

## ------------------------------------------------------------------------
2 * 2 == 4

## ------------------------------------------------------------------------
weight_kg <- 55

## ------------------------------------------------------------------------
weight_kg

## ------------------------------------------------------------------------
# weight in pounds:
2.2 * weight_kg

## ------------------------------------------------------------------------
myvec <- c(10,20,30,40,50)
myvec + 1
myvec + myvec

## ------------------------------------------------------------------------
c(myvec, myvec)
c(60, myvec)
length(myvec)

## ------------------------------------------------------------------------
factor(c("mutant","wildtype","mutant"), 
       levels=c("wildtype","mutant"))

## ------------------------------------------------------------------------
myvec[1]
myvec[2]
myvec[2] <- 5
myvec

## ------------------------------------------------------------------------
myind <- c(4,3,2)
myvec[myind]

## ------------------------------------------------------------------------
myvec[c(4,3,2)]

## ------------------------------------------------------------------------
myvec[3:5]

## ------------------------------------------------------------------------
3:5
1:50
numbers <- 1:10
numbers*numbers

## ------------------------------------------------------------------------
sum(myvec)

## ------------------------------------------------------------------------
rep(42, 10)

## ------------------------------------------------------------------------
rep(c(1,2,3), 10)

## ------------------------------------------------------------------------
rep(c(1,2,3), times=10)
rep(x=c(1,2,3), 10)
rep(x=c(1,2,3), times=10)

## ------------------------------------------------------------------------
rep(c(1,2,3), each=3)
rep(c(1,2,3), each=3, times=5)

## ------------------------------------------------------------------------
mylist <- list(num=42, greeting="Hello, world")
mylist$greeting
mylist[[2]]

## ----eval=FALSE----------------------------------------------------------
## class(myvec)
## class(mylist)
## str(mylist)

## ------------------------------------------------------------------------
ls()

## ------------------------------------------------------------------------
rm(myvec)
ls()

## ------------------------------------------------------------------------
search()

## ---- eval=FALSE---------------------------------------------------------
## > spss.get
## Error: object 'spss.get' not found

## ----eval=FALSE----------------------------------------------------------
## install.packages(c("devtools", "foreign", "Hmisc", "readxl",
##                    "readstata13", "Epi", "car"))

## ----eval=FALSE----------------------------------------------------------
## library(devtools)
## install_github("isglobal-brge/SNPassoc")

## ----eval=FALSE----------------------------------------------------------
## devtools::install_github("isglobal-brge/SNPassoc")

## ------------------------------------------------------------------------
getwd()

## ----setwd---------------------------------------------------------------
setwd("c:/Juan/CREAL/GitHub/R_course")

ff <- "c:/Juan/CREAL/GitHub/R_course/Day1-Introduction"
dir(ff)
dir("data")
file.path(ff, "data/parto2.dat")

## ------------------------------------------------------------------------
data(CO2, package="datasets")
head(CO2)

## ------------------------------------------------------------------------
library(foreign)
library(Hmisc)
library(readxl)

## ------------------------------------------------------------------------
df<-read.table("data/parto2.dat", sep=";", as.is=TRUE, 
               header=FALSE)
head(df)

## ------------------------------------------------------------------------
df<-read_excel("data/mujeres.xlsx")
class(df)
class(df) <- "data.frame"
head(df)

## ------------------------------------------------------------------------
df <- read.dta("data/partoFin.dta",
             convert.dates = TRUE, convert.factors = TRUE)
head(df)

## ---- eval=FALSE---------------------------------------------------------
## library(readstata13)
## df <- read.dta13("data/partoFin.dta",
##              convert.dates = TRUE, convert.factors = TRUE)

## ------------------------------------------------------------------------
df <- spss.get("data/parto2.sav",use.value.labels=TRUE, allow="_", 
             datevars=c("dia_nac","dia_entr","ulti_lac"))
head(df)

## ---- eval=FALSE---------------------------------------------------------
## write.table(df,"parto2ex.dat")

## ---- eval=FALSE---------------------------------------------------------
## write.dta(df, file="c:/juan/data/bd.dta"), version=7L)
## save.dta13(df, file="c:/juan/data/bd.dta")

## ---- eval=FALSE---------------------------------------------------------
## save(df, file="c:/juan/data/bd.Rdata")) # or .rda

## ---- eval=FALSE---------------------------------------------------------
## load("c:/juan/data/bd.Rdata")) # an object df will be in R

## ------------------------------------------------------------------------
library(Hmisc)
df <- spss.get("data/partoFin.sav", allow="_", 
               datevars=c("dia_nac", "dia_entr", "ulti_lac"))

## ------------------------------------------------------------------------
head(df)

## ------------------------------------------------------------------------
str(df)

## ---- eval=FALSE---------------------------------------------------------
## View(df)

## ------------------------------------------------------------------------
df$edad2 <- df$edad*df$edad

## ------------------------------------------------------------------------
df$edad.c <- cut(df$edad, c(-Inf, 20, 25, Inf),
                 labels=c("low", "med", "high"))
table(df$edad.c)

## ------------------------------------------------------------------------
df$edad.c2 <- cut(df$edad, seq(0,50,5))
table(df$edad.c2)

## ------------------------------------------------------------------------
df$edad.c3 <- cut(df$edad, quantile(df$edad),
                  label=c("1st", "2nd", "3rd", "4th"))
table(df$edad.c3)

## ------------------------------------------------------------------------
table(df$naci_ca)
levels(df$naci_ca)
df$naci_ca2 <- df$naci_ca
levels(df$naci_ca2) <- c("Española", "Extranjero", "Extranjero")
table(df$naci_ca2)

## ------------------------------------------------------------------------
df$naci_ca3 <- relevel(df$naci_ca2, 2)
table(df$naci_ca3)

## ------------------------------------------------------------------------
nrow(df)
ncol(df)

## ------------------------------------------------------------------------
names(df)

## ------------------------------------------------------------------------
summary(df)

## ------------------------------------------------------------------------
df$sexo

## ------------------------------------------------------------------------
df[,2]

## ------------------------------------------------------------------------
df[,c("sexo", "peso", "edad")]

## ------------------------------------------------------------------------
df[,c(1,3,5)]

## ------------------------------------------------------------------------
df[4,]

## ------------------------------------------------------------------------
df[4:10,]

## ------------------------------------------------------------------------
subset(df, sexo=="niña")

## ------------------------------------------------------------------------
table(df$naci_ca)
subset(df, naci_ca%in%c("Española", "Otras"))

## ------------------------------------------------------------------------
mean(df$edad)

## ------------------------------------------------------------------------
sd(df$edad)

## ------------------------------------------------------------------------
median(df$edad)

## ---- eval=FALSE---------------------------------------------------------
## var, quantile, range, ...

## ------------------------------------------------------------------------
g <- function(x)c(Mean=mean(x,na.rm=TRUE),
                  Median=median(x,na.rm=TRUE),
                  Sd=sd(x,na.rm=TRUE))
summary(peso~sexo+tx, data=df, fun = g)

## ------------------------------------------------------------------------
library(Epi)
stat.table(list(Sexo = sexo, Visitas = tx), list(N = count(), 
    `%` = percent(tx)), data = df, margins = T)

## ------------------------------------------------------------------------
hist(df$peso, col="blue", breaks = 10, 
     main="Peso", xlab="")

## ------------------------------------------------------------------------
plot(df$sexo, col="darkgreen")

## ------------------------------------------------------------------------
boxplot(df$peso, ylab="Peso (kgs.)")

## ------------------------------------------------------------------------
boxplot(peso ~ sexo , data=df, col="red", 
        ylab="Peso (kgs.)", xlab="Sexo")

## ------------------------------------------------------------------------
plot(peso ~ edad, data=df, col=sexo, pch=19)
title("Weight by mother age")
legend("topright", c("boy","girl"), fill=c(1,2))

## ------------------------------------------------------------------------
with(df, cor(peso, edad))

## ------------------------------------------------------------------------
with(df, cor(peso, edad, method="spearman"))

## ------------------------------------------------------------------------
sessionInfo()

